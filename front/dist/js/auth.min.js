function Auth(){this.signinBtn=$(".signin-btn"),this.signupBtn=$(".signup-btn"),this.closeBtn=$(".close-btn"),this.maskWrapper=$(".mask-wrapper"),this.switch=$(".switch"),this.scrollWrapper=$(".scroll-wrapper"),this.smsCaptchaBtn=$(".sms-captcha-btn")}Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptchaBtn.addClass("disabled");var n=60;t.smsCaptchaBtn.unbind("click");var e=setInterval(function(){t.smsCaptchaBtn.text(n+"s"),--n<=0&&(clearInterval(e),t.smsCaptchaBtn.removeClass("disabled"),t.smsCaptchaBtn.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenShowHideEvent=function(){var t=this;t.signinBtn.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),t.signupBtn.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),t.closeBtn.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var n=this;n.switch.click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),i=t.find("input[name='password']"),c=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=i.val(),e=c.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){if(200==t.code)a.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var s=n[e][0];window.messageBox.show(s)}}},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignupEvent=function(){var m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),s=m.find("input[name='img_captcha']"),a=m.find("input[name='password1']"),i=m.find("input[name='password2']"),c=m.find("input[name='sms_captcha']"),o=n.val(),p=e.val(),r=s.val(),l=a.val(),u=i.val(),h=c.val();xfzajax.post({url:"/account/register/",data:{telephone:o,username:p,img_captcha:r,password1:l,password2:u,sms_captcha:h},success:function(t){window.location.reload()}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,e=$(".signup-group input[name='telephone']");n.smsCaptchaBtn.click(function(){var t=e.val();t?xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccessEvent()},fail:function(t){console.log(t)}}):messageBox.showInfo("请输入手机号码！")})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},$(function(){(new Auth).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiQXV0aCIsInRoaXMiLCJzaWduaW5CdG4iLCIkIiwic2lnbnVwQnRuIiwiY2xvc2VCdG4iLCJtYXNrV3JhcHBlciIsInN3aXRjaCIsInNjcm9sbFdyYXBwZXIiLCJzbXNDYXB0Y2hhQnRuIiwicHJvdG90eXBlIiwic2hvd0V2ZW50Iiwic2hvdyIsImhpZGVFdmVudCIsImhpZGUiLCJzbXNTdWNjZXNzRXZlbnQiLCJzZWxmIiwibWVzc2FnZUJveCIsInNob3dTdWNjZXNzIiwiYWRkQ2xhc3MiLCJjb3VudCIsInVuYmluZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50IiwibGlzdGVuU2hvd0hpZGVFdmVudCIsImNsaWNrIiwiY3NzIiwibGVmdCIsImxpc3RlblN3aXRjaEV2ZW50IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJsaXN0ZW5TaWduaW5FdmVudCIsInNpZ25pbkdyb3VwIiwidGVsZXBob25lSW5wdXQiLCJmaW5kIiwicGFzc3dvcmRJbnB1dCIsInJlbWVtYmVySW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsInhmemFqYXgiLCJwb3N0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsIm1lc3NhZ2VPYmplY3QiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsImtleSIsIm1lc3NhZ2UiLCJmYWlsIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaWdudXBHcm91cCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VybmFtZUlucHV0IiwiaW1nQ2FwdGNoYUlucHV0IiwicGFzc3dvcmQxSW5wdXQiLCJwYXNzd29yZDJJbnB1dCIsInNtc0NhcHRjaGFJbnB1dCIsInVzZXJuYW1lIiwiaW1nX2NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJzbXNfY2FwdGNoYSIsImxpc3RlbkltZ0NhcHRjaGFFdmVudCIsImltZ0NhcHRjaGEiLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsImdldCIsInNob3dJbmZvIiwicnVuIl0sIm1hcHBpbmdzIjoiQUF3QkEsU0FBU0EsT0FDTEMsS0FBS0MsVUFBWUMsRUFBRSxlQUNuQkYsS0FBS0csVUFBWUQsRUFBRSxlQUNuQkYsS0FBS0ksU0FBV0YsRUFBRSxjQUNsQkYsS0FBS0ssWUFBY0gsRUFBRSxpQkFDckJGLEtBQUtNLE9BQVNKLEVBQUUsV0FDaEJGLEtBQUtPLGNBQWdCTCxFQUFFLG1CQUN2QkYsS0FBS1EsY0FBZ0JOLEVBQUUsb0JBRzNCSCxLQUFLVSxVQUFVQyxVQUFZLFdBQ1pWLEtBQ05LLFlBQVlNLFFBR3JCWixLQUFLVSxVQUFVRyxVQUFZLFdBQ1paLEtBQ05LLFlBQVlRLFFBR3JCZCxLQUFLVSxVQUFVSyxnQkFBa0IsV0FDN0IsSUFBSUMsRUFBT2YsS0FDWGdCLFdBQVdDLFlBQVksY0FDdkJGLEVBQUtQLGNBQWNVLFNBQVMsWUFDNUIsSUFBSUMsRUFBUSxHQUNaSixFQUFLUCxjQUFjWSxPQUFPLFNBQzFCLElBQUlDLEVBQVFDLFlBQVksV0FDcEJQLEVBQUtQLGNBQWNlLEtBQUtKLEVBQVEsT0FDaENBLEdBQ2EsSUFDVEssY0FBY0gsR0FDZE4sRUFBS1AsY0FBY2lCLFlBQVksWUFDL0JWLEVBQUtQLGNBQWNlLEtBQUssU0FDeEJSLEVBQUtXLDBCQUVWLE1BR1AzQixLQUFLVSxVQUFVa0Isb0JBQXNCLFdBQ2pDLElBQUlaLEVBQU9mLEtBQ1hlLEVBQUtkLFVBQVUyQixNQUFNLFdBQ2pCYixFQUFLTCxZQUNMSyxFQUFLUixjQUFjc0IsSUFBSSxDQUFFQyxLQUFRLE1BR3JDZixFQUFLWixVQUFVeUIsTUFBTSxXQUNqQmIsRUFBS0wsWUFDTEssRUFBS1IsY0FBY3NCLElBQUksQ0FBRUMsTUFBUyxRQUd0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LGVBb0JoQ3JGLEtBQUtVLFVBQVU0RSxJQUFNLFdBQ2pCLElBQUl0RSxFQUFPZixLQUNYZSxFQUFLWSxzQkFDTFosRUFBS2dCLG9CQUNMaEIsRUFBS29CLG9CQUNMcEIsRUFBSytELHdCQUNML0QsRUFBS1csd0JBQ0xYLEVBQUtpRCxxQkFHVDlELEVBQUUsWUFDYSxJQUFJSCxNQUNWc0YiLCJmaWxlIjoiYXV0aC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyDngrnlh7vnmbvlvZXmjInpkq7vvIzlvLnlh7rmqKHmgIHlr7nor53moYZcclxuLy8gJChmdW5jdGlvbigpIHtcclxuLy8gICAgICQoXCIuc2lnbmluLWJ0blwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5zaG93KCk7XHJcbi8vICAgICB9KTtcclxuXHJcbi8vICAgICAkKFwiLmNsb3NlLWJ0blwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5oaWRlKCk7XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG4vLyAkKGZ1bmN0aW9uKCkge1xyXG4vLyAgICAgJChcIi5zd2l0Y2hcIikuY2xpY2soZnVuY3Rpb24oKSB7XHJcbi8vICAgICAgICAgdmFyIHNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4vLyAgICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuLy8gICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuLy8gICAgICAgICBpZiAoY3VycmVudExlZnQgPCAwKSB7XHJcbi8vICAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7ICdsZWZ0JzogJzAnIH0pO1xyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7ICdsZWZ0JzogJy00MDBweCcgfSlcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5mdW5jdGlvbiBBdXRoKCkge1xyXG4gICAgdGhpcy5zaWduaW5CdG4gPSAkKFwiLnNpZ25pbi1idG5cIik7XHJcbiAgICB0aGlzLnNpZ251cEJ0biA9ICQoXCIuc2lnbnVwLWJ0blwiKTtcclxuICAgIHRoaXMuY2xvc2VCdG4gPSAkKFwiLmNsb3NlLWJ0blwiKTtcclxuICAgIHRoaXMubWFza1dyYXBwZXIgPSAkKFwiLm1hc2std3JhcHBlclwiKTtcclxuICAgIHRoaXMuc3dpdGNoID0gJChcIi5zd2l0Y2hcIik7XHJcbiAgICB0aGlzLnNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4gICAgdGhpcy5zbXNDYXB0Y2hhQnRuID0gJChcIi5zbXMtY2FwdGNoYS1idG5cIik7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5zaG93KCk7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5oaWRlKCk7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLnNtc1N1Y2Nlc3NFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2VzcyhcIuefreS/oemqjOivgeeggeWPkemAgeaIkOWKn++8gVwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYUJ0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgIHZhciBjb3VudCA9IDYwO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhQnRuLnVuYmluZCgnY2xpY2snKTtcclxuICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHNlbGYuc21zQ2FwdGNoYUJ0bi50ZXh0KGNvdW50ICsgJ3MnKTtcclxuICAgICAgICBjb3VudC0tO1xyXG4gICAgICAgIGlmIChjb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGFCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYUJ0bi50ZXh0KFwi5Y+R6YCB6aqM6K+B56CBXCIpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDApO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93SGlkZUV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLnNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoeyBcImxlZnRcIjogMCB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNlbGYuc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7IFwibGVmdFwiOiAtNDAwIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2VsZi5jbG9zZUJ0bi5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblN3aXRjaEV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLnN3aXRjaC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuICAgICAgICBpZiAoY3VycmVudExlZnQgPCAwKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHsgJ2xlZnQnOiAnMCcgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoeyAnbGVmdCc6ICctNDAwcHgnIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWduaW5FdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcblxyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkID0gcGFzc3dvcmRJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXIgPyAxIDogMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IHJlc3VsdFsnbWVzc2FnZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZU9iamVjdCA9PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09IFN0cmluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHtcInBhc3N3b3JkXCI6Wyflr4bnoIHmnIDlpKfplb/luqbkuI3og73otoXov4cyMOS4uu+8gScsJ3h4eCddLFwidGVsZXBob25lXCI6Wyd4eCcsJ3gnXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG1lc3NhZ2VPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmplY3Rba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNpZ251cEdyb3VwID0gJChcIi5zaWdudXAtZ3JvdXBcIik7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbnVwR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndXNlcm5hbWUnXVwiKTtcclxuICAgICAgICB2YXIgaW1nQ2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J2ltZ19jYXB0Y2hhJ11cIik7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDInXVwiKTtcclxuICAgICAgICB2YXIgc21zQ2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Ntc19jYXB0Y2hhJ11cIik7XHJcblxyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VybmFtZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBpbWdfY2FwdGNoYSA9IGltZ0NhcHRjaGFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQxID0gcGFzc3dvcmQxSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMiA9IHBhc3N3b3JkMklucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBzbXNfY2FwdGNoYSA9IHNtc0NhcHRjaGFJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6IFwiL2FjY291bnQvcmVnaXN0ZXIvXCIsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ2ltZ19jYXB0Y2hhJzogaW1nX2NhcHRjaGEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMic6IHBhc3N3b3JkMixcclxuICAgICAgICAgICAgICAgICdzbXNfY2FwdGNoYSc6IHNtc19jYXB0Y2hhXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBpbWdDYXB0Y2hhID0gJChcIi5pbWctY2FwdGNoYVwiKTtcclxuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaW1nQ2FwdGNoYS5hdHRyKFwic3JjXCIsICcvYWNjb3VudC9pbWdfY2FwdGNoYS8nICsgJz9yYW5kb209JyArIE1hdGgucmFuZG9tKCkpXHJcbiAgICB9KTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYUJ0bi5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgaWYgKCF0ZWxlcGhvbmUpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygn6K+36L6T5YWl5omL5py65Y+356CB77yBJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc1N1Y2Nlc3NFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuSW1nQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TaWdudXBFdmVudCgpO1xyXG59XHJcblxyXG4kKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICAgYXV0aC5ydW4oKTtcclxufSk7Il19
