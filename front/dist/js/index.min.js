function Banner(){this.pageWidth=795,this.bannerGroup=$("#banner-group"),this.index=1,this.bannerUl=$("#banner-ul"),this.liList=this.bannerUl.children("li"),this.leftArrow=$(".left-arrow"),this.rightArrow=$(".right-arrow"),this.bannerCount=this.liList.length,this.pageControl=$(".page-control")}function Index(){this.loadMoreBtn=$("#load-more-btn"),this.page=2,this.category_id=0,template.defaults.imports.timeSince=function(n){var t=new Date(n),e=t.getTime(),i=((new Date).getTime()-e)/1e3;return i<60?"刚刚":60<=i&&i<3600?(minutes=parseInt(i/60),minutes+" 分钟前"):3600<=i&&i<86400?(hours=parseInt(i/60/60),hours+" 小时前"):86400<=i&&i<2592e3?(days=parseInt(i/60/60/24),days+" 天前"):t.getFullYear()+"/"+t.getMonth()+"/"+t.getDay()+" "+t.getHours()+":"+t.getMinutes()}}Banner.prototype.initBanner=function(){var n=this,t=n.liList.eq(0).clone(),e=n.liList.eq(n.bannerCount-1).clone();this.bannerUl.append(t),this.bannerUl.prepend(e),this.bannerUl.css({width:n.pageWidth*(n.bannerCount+2),left:-n.pageWidth})},Banner.prototype.initPageControl=function(){for(var n=this,t=0;t<n.bannerCount;t++){var e=$("<li></li>");n.pageControl.append(e),0===t&&e.addClass("active")}n.pageControl.css({width:16+10*n.bannerCount+16*(n.bannerCount-1)})},Banner.prototype.animate=function(){var n=this;n.bannerUl.animate({left:-795*n.index},500);var t=n.index;t=0===t?n.bannerCount-1:t===n.bannerCount+1?0:n.index-1,n.pageControl.children("li").eq(t).addClass("active").siblings().removeClass("active")},Banner.prototype.loop=function(){var n=this;this.timer=setInterval(function(){n.index>=n.bannerCount+1?(n.bannerUl.css({left:-n.pageWidth}),n.index=2):n.index++,n.animate()},2e3)},Banner.prototype.listenArrowClick=function(){var n=this;this.leftArrow.click(function(){0==n.index?(n.bannerUl.css({left:-n.bannerCount*n.pageWidth}),n.index=n.bannerCount-1):n.index--,n.animate()}),this.rightArrow.click(function(){n.index==n.bannerCount+1?(n.bannerUl.css({left:-n.pageWidth}),n.index=2):n.index++,n.animate()})},Banner.prototype.listenBannerHover=function(){var n=this;this.bannerGroup.hover(function(){clearInterval(n.timer)},function(){n.loop()})},Banner.prototype.listenPageControl=function(){var e=this;this.pageControl.children("li").each(function(n,t){$(t).click(function(){e.index=n+1,e.animate()})})},Banner.prototype.run=function(){this.initBanner(),this.initPageControl(),this.loop(),this.listenBannerHover(),this.listenArrowClick(),this.listenPageControl()},Index.prototype.listenLoadMoreEvent=function(){var i=this;i.loadMoreBtn.click(function(){xfzajax.get({url:"/news/list/",data:{page:i.page,category_id:i.category_id},success:function(n){if(200===n.code){var t=n.data;if(0<t.length){var e=template("news-item",{newses:t});$(".list-inner-group").append(e),i.page+=1}else i.loadMoreBtn.hide()}}})})},Index.prototype.listenCatporySwitchEvent=function(){var o=this;$(".list-tab").children().click(function(){var a=$(this),r=a.attr("data-category");xfzajax.get({url:"/news/list/",data:{page:1,category_id:r},success:function(n){if(200===n.code){var t=n.data,e=template("news-item",{newses:t}),i=$(".list-inner-group");i.empty(),i.append(e),o.page=2,o.category_id=r,a.addClass("active").siblings().removeClass("active"),o.loadMoreBtn.show()}}})})},Index.prototype.run=function(){this.listenLoadMoreEvent(),this.listenCatporySwitchEvent()},$(function(){(new Banner).run(),(new Index).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkJhbm5lciIsInRoaXMiLCJwYWdlV2lkdGgiLCJiYW5uZXJHcm91cCIsIiQiLCJpbmRleCIsImJhbm5lclVsIiwibGlMaXN0IiwiY2hpbGRyZW4iLCJsZWZ0QXJyb3ciLCJyaWdodEFycm93IiwiYmFubmVyQ291bnQiLCJsZW5ndGgiLCJwYWdlQ29udHJvbCIsIkluZGV4IiwibG9hZE1vcmVCdG4iLCJwYWdlIiwiY2F0ZWdvcnlfaWQiLCJ0ZW1wbGF0ZSIsImRlZmF1bHRzIiwiaW1wb3J0cyIsInRpbWVTaW5jZSIsImRhdGVWYWx1ZSIsImRhdGUiLCJEYXRlIiwiZGF0ZXRzIiwiZ2V0VGltZSIsInRpbWVzdGFtcCIsIm1pbnV0ZXMiLCJwYXJzZUludCIsImhvdXJzIiwiZGF5cyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJwcm90b3R5cGUiLCJpbml0QmFubmVyIiwic2VsZiIsImZpcnN0TGkiLCJlcSIsImNsb25lIiwibGFzdExpIiwiYXBwZW5kIiwicHJlcGVuZCIsImNzcyIsIndpZHRoIiwibGVmdCIsImluaXRQYWdlQ29udHJvbCIsImkiLCJjaXJjbGUiLCJhZGRDbGFzcyIsImFuaW1hdGUiLCJzaWJsaW5ncyIsInJlbW92ZUNsYXNzIiwibG9vcCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJsaXN0ZW5BcnJvd0NsaWNrIiwiY2xpY2siLCJsaXN0ZW5CYW5uZXJIb3ZlciIsImhvdmVyIiwiY2xlYXJJbnRlcnZhbCIsImxpc3RlblBhZ2VDb250cm9sIiwiZWFjaCIsIm9iaiIsInJ1biIsImxpc3RlbkxvYWRNb3JlRXZlbnQiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJuZXdzZXMiLCJ0cGwiLCJoaWRlIiwibGlzdGVuQ2F0cG9yeVN3aXRjaEV2ZW50IiwibGkiLCJhdHRyIiwibmV3TGlzdEdyb3VwIiwiZW1w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QXVCLE1BQW5CQSxFQUFhLEtBQVcsQ0FDeEIsSUFBSUMsRUFBU0QsRUFBYSxLQUMxQixHQUFvQixFQUFoQkMsRUFBTy9ELE9BQVksQ0FDbkIsSUFBSWdFLEVBQU0xRCxTQUFTLFlBQWEsQ0FBRXlELE9BQVVBLElBQ25DdkUsRUFBRSxxQkFDUndDLE9BQU9nQyxHQUNWckMsRUFBS3ZCLE1BQVEsT0FFYnVCLEVBQUt4QixZQUFZOEQsY0FRekMvRCxNQUFNdUIsVUFBVXlDLHlCQUEyQixXQUN2QyxJQUFJdkMsRUFBT3RDLEtBQ0dHLEVBQUUsYUFDUkksV0FBV29ELE1BQU0sV0FDckIsSUFBSW1CLEVBQUszRSxFQUFFSCxNQUNQZ0IsRUFBYzhELEVBQUdDLEtBQUssaUJBRTFCWCxRQUFRQyxJQUFJLENBQ1JDLElBQU8sY0FDUEMsS0FBUSxDQUNKeEQsS0FKRyxFQUtIQyxZQUFlQSxHQUVuQndELFFBQVcsU0FBU0MsR0FDaEIsR0FBdUIsTUFBbkJBLEVBQWEsS0FBVyxDQUN4QixJQUFJQyxFQUFTRCxFQUFhLEtBQ3RCRSxFQUFNMUQsU0FBUyxZQUFhLENBQUV5RCxPQUFVQSxJQUN4Q00sRUFBZTdFLEVBQUUscUJBQ3JCNkUsRUFBYUMsUUFDYkQsRUFBYXJDLE9BQU9nQyxHQUNwQnJDLEVBQUt2QixLQUFPLEVBQ1p1QixFQUFLdEIsWUFBY0EsRUFDbkI4RCxFQUFHM0IsU0FBUyxVQUFVRSxXQUFXQyxZQUFZLFVBQzdDaEIsRUFBS3hCLFlBQVlvRSxjQU9yQ3JFLE1BQU11QixVQUFVOEIsSUFBTSxXQUNsQmxFLEtBQUttRSxzQkFDTG5FLEtBQUs2RSw0QkFHVDFFLEVBQUUsWUFDZSxJQUFJSixRQUNWbUUsT0FFSyxJQUFJckQsT0FDVnFEIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEJhbm5lcigpIHtcclxuICAgIHRoaXMucGFnZVdpZHRoID0gNzk1O1xyXG4gICAgdGhpcy5iYW5uZXJHcm91cCA9ICQoXCIjYmFubmVyLWdyb3VwXCIpO1xyXG4gICAgdGhpcy5pbmRleCA9IDE7XHJcbiAgICB0aGlzLmJhbm5lclVsID0gJChcIiNiYW5uZXItdWxcIik7XHJcbiAgICB0aGlzLmxpTGlzdCA9IHRoaXMuYmFubmVyVWwuY2hpbGRyZW4oXCJsaVwiKTtcclxuICAgIHRoaXMubGVmdEFycm93ID0gJChcIi5sZWZ0LWFycm93XCIpO1xyXG4gICAgdGhpcy5yaWdodEFycm93ID0gJChcIi5yaWdodC1hcnJvd1wiKTtcclxuICAgIHRoaXMuYmFubmVyQ291bnQgPSB0aGlzLmxpTGlzdC5sZW5ndGg7XHJcbiAgICB0aGlzLnBhZ2VDb250cm9sID0gJChcIi5wYWdlLWNvbnRyb2xcIik7XHJcbn1cclxuXHJcbkJhbm5lci5wcm90b3R5cGUuaW5pdEJhbm5lciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGZpcnN0TGkgPSBzZWxmLmxpTGlzdC5lcSgwKS5jbG9uZSgpO1xyXG4gICAgdmFyIGxhc3RMaSA9IHNlbGYubGlMaXN0LmVxKHNlbGYuYmFubmVyQ291bnQgLSAxKS5jbG9uZSgpO1xyXG4gICAgdGhpcy5iYW5uZXJVbC5hcHBlbmQoZmlyc3RMaSk7XHJcbiAgICB0aGlzLmJhbm5lclVsLnByZXBlbmQobGFzdExpKTtcclxuICAgIHRoaXMuYmFubmVyVWwuY3NzKHsgXCJ3aWR0aFwiOiBzZWxmLnBhZ2VXaWR0aCAqIChzZWxmLmJhbm5lckNvdW50ICsgMiksIFwibGVmdFwiOiAtc2VsZi5wYWdlV2lkdGggfSk7XHJcbn1cclxuXHJcbkJhbm5lci5wcm90b3R5cGUuaW5pdFBhZ2VDb250cm9sID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYmFubmVyQ291bnQ7IGkrKykge1xyXG4gICAgICAgIHZhciBjaXJjbGUgPSAkKFwiPGxpPjwvbGk+XCIpO1xyXG4gICAgICAgIHNlbGYucGFnZUNvbnRyb2wuYXBwZW5kKGNpcmNsZSk7XHJcbiAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgY2lyY2xlLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY3NzKHsgXCJ3aWR0aFwiOiAyICogOCArIHNlbGYuYmFubmVyQ291bnQgKiAxMCArIDE2ICogKHNlbGYuYmFubmVyQ291bnQgLSAxKSB9KVxyXG59XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuYmFubmVyVWwuYW5pbWF0ZSh7IFwibGVmdFwiOiAtNzk1ICogc2VsZi5pbmRleCB9LCA1MDApO1xyXG4gICAgdmFyIGluZGV4ID0gc2VsZi5pbmRleDtcclxuICAgIGlmIChpbmRleCA9PT0gMCkge1xyXG4gICAgICAgIGluZGV4ID0gc2VsZi5iYW5uZXJDb3VudCAtIDE7XHJcbiAgICB9IGVsc2UgaWYgKGluZGV4ID09PSBzZWxmLmJhbm5lckNvdW50ICsgMSkge1xyXG4gICAgICAgIGluZGV4ID0gMDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5kZXggPSBzZWxmLmluZGV4IC0gMTtcclxuICAgIH1cclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY2hpbGRyZW4oXCJsaVwiKS5lcShpbmRleCkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxufVxyXG5cclxuQmFubmVyLnByb3RvdHlwZS5sb29wID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHNlbGYuaW5kZXggPj0gc2VsZi5iYW5uZXJDb3VudCArIDEpIHtcclxuICAgICAgICAgICAgc2VsZi5iYW5uZXJVbC5jc3MoeyBcImxlZnRcIjogLXNlbGYucGFnZVdpZHRoIH0pO1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ID0gMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuYW5pbWF0ZSgpO1xyXG4gICAgfSwgMjAwMCk7XHJcbn1cclxuXHJcbkJhbm5lci5wcm90b3R5cGUubGlzdGVuQXJyb3dDbGljayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5sZWZ0QXJyb3cuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHNlbGYuaW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgICBzZWxmLmJhbm5lclVsLmNzcyh7IFwibGVmdFwiOiAtc2VsZi5iYW5uZXJDb3VudCAqIHNlbGYucGFnZVdpZHRoIH0pO1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ID0gc2VsZi5iYW5uZXJDb3VudCAtIDE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5pbmRleC0tO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLmFuaW1hdGUoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5yaWdodEFycm93LmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChzZWxmLmluZGV4ID09IHNlbGYuYmFubmVyQ291bnQgKyAxKSB7XHJcbiAgICAgICAgICAgIHNlbGYuYmFubmVyVWwuY3NzKHsgXCJsZWZ0XCI6IC1zZWxmLnBhZ2VXaWR0aCB9KTtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCA9IDI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLmFuaW1hdGUoKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbkJhbm5lci5wcm90b3R5cGUubGlzdGVuQmFubmVySG92ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMuYmFubmVyR3JvdXAuaG92ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbChzZWxmLnRpbWVyKVxyXG4gICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2VsZi5sb29wKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuQmFubmVyLnByb3RvdHlwZS5saXN0ZW5QYWdlQ29udHJvbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5wYWdlQ29udHJvbC5jaGlsZHJlbihcImxpXCIpLmVhY2goZnVuY3Rpb24oaW5kZXgsIG9iaikge1xyXG4gICAgICAgICQob2JqKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCA9IGluZGV4ICsgMTtcclxuICAgICAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuQmFubmVyLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuaW5pdEJhbm5lcigpO1xyXG4gICAgdGhpcy5pbml0UGFnZUNvbnRyb2woKTtcclxuICAgIHRoaXMubG9vcCgpO1xyXG4gICAgdGhpcy5saXN0ZW5CYW5uZXJIb3ZlcigpO1xyXG4gICAgdGhpcy5saXN0ZW5BcnJvd0NsaWNrKCk7XHJcbiAgICB0aGlzLmxpc3RlblBhZ2VDb250cm9sKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEluZGV4KCkge1xyXG4gICAgdGhpcy5sb2FkTW9yZUJ0biA9ICQoXCIjbG9hZC1tb3JlLWJ0blwiKTtcclxuICAgIHRoaXMucGFnZSA9IDI7XHJcbiAgICB0aGlzLmNhdGVnb3J5X2lkID0gMDtcclxuXHJcbiAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uKGRhdGVWYWx1ZSkge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7XHJcbiAgICAgICAgdmFyIG5vd3RzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKSAvIDEwMDA7XHJcbiAgICAgICAgaWYgKHRpbWVzdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAn5Yia5YiaJ1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjApIHtcclxuICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1pbnV0ZXMgKyAnIOWIhumSn+WJjSdcclxuICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCAqIDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCkge1xyXG4gICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjApO1xyXG4gICAgICAgICAgICByZXR1cm4gaG91cnMgKyAnIOWwj+aXtuWJjSdcclxuICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCAqIDYwICogMjQgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCAqIDI0ICogMzApIHtcclxuICAgICAgICAgICAgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXlzICsgJyDlpKnliY0nXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcclxuICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB5ZWFyICsgXCIvXCIgKyBtb250aCArIFwiL1wiICsgZGF5ICsgXCIgXCIgKyBob3VyICsgXCI6XCIgKyBtaW51dGVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbkluZGV4LnByb3RvdHlwZS5saXN0ZW5Mb2FkTW9yZUV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxvYWRNb3JlQnRuLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHhmemFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvbmV3cy9saXN0LycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3BhZ2UnOiBzZWxmLnBhZ2UsXHJcbiAgICAgICAgICAgICAgICAnY2F0ZWdvcnlfaWQnOiBzZWxmLmNhdGVnb3J5X2lkLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3c2VzID0gcmVzdWx0WydkYXRhJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld3Nlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZShcIm5ld3MtaXRlbVwiLCB7ICduZXdzZXMnOiBuZXdzZXMgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1bCA9ICQoXCIubGlzdC1pbm5lci1ncm91cFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwuYXBwZW5kKHRwbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGFnZSArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZE1vcmVCdG4uaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbkluZGV4LnByb3RvdHlwZS5saXN0ZW5DYXRwb3J5U3dpdGNoRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciB1bEdyb3VwID0gJCgnLmxpc3QtdGFiJyk7XHJcbiAgICB1bEdyb3VwLmNoaWxkcmVuKCkuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGxpID0gJCh0aGlzKTtcclxuICAgICAgICB2YXIgY2F0ZWdvcnlfaWQgPSBsaS5hdHRyKFwiZGF0YS1jYXRlZ29yeVwiKTtcclxuICAgICAgICB2YXIgcGFnZSA9IDE7XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9uZXdzL2xpc3QvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAncGFnZSc6IHBhZ2UsXHJcbiAgICAgICAgICAgICAgICAnY2F0ZWdvcnlfaWQnOiBjYXRlZ29yeV9pZCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld3NlcyA9IHJlc3VsdFsnZGF0YSddO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZSgnbmV3cy1pdGVtJywgeyAnbmV3c2VzJzogbmV3c2VzIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdMaXN0R3JvdXAgPSAkKFwiLmxpc3QtaW5uZXItZ3JvdXBcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3TGlzdEdyb3VwLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3TGlzdEdyb3VwLmFwcGVuZCh0cGwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGFnZSA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYXRlZ29yeV9pZCA9IGNhdGVnb3J5X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpLmFkZENsYXNzKCdhY3RpdmUnKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYWRNb3JlQnRuLnNob3coKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbkluZGV4LnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMubGlzdGVuTG9hZE1vcmVFdmVudCgpO1xyXG4gICAgdGhpcy5saXN0ZW5DYXRwb3J5U3dpdGNoRXZlbnQoKTtcclxufVxyXG5cclxuJChmdW5jdGlvbigpIHtcclxuICAgIHZhciBiYW5uZXIgPSBuZXcgQmFubmVyKCk7XHJcbiAgICBiYW5uZXIucnVuKCk7XHJcblxyXG4gICAgdmFyIGluZGV4ID0gbmV3IEluZGV4KCk7XHJcbiAgICBpbmRleC5ydW4oKTtcclxufSk7Il19
